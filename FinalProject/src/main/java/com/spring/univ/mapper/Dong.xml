<?xml version="1.0" encoding="UTF-8"?>

<!-- ====  mapper 기본설정 ==== -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- ====  루트 엘리먼트 & 네임스페이스 설정(프로젝트 전체내에서 유일해야 한다.) ==== -->
<mapper namespace="Dong">
	<!-- 로그인  -->
	<select id="getLoginMember" parameterType="HashMap" resultType="com.spring.univ.model.MemberVO">
		select hakbun, name, birth, fk_deptCode, pwd, email,
		address, status,picture,phone,authority
		from tbl_member
		where status = 1 and hakbun = #{hakbun} and pwd = #{pwd}
	</select>
	
	<!-- 교수 보여주기 -->
	<select id="getTeacher" resultType="com.spring.univ.model.SubjectVO">
		select code,subject,hakjum,classdate,fk_deptcode
		from tbl_subject
	</select>
	
	<!-- 개인정보 수정하기-->
	<update id="MyUpdate" parameterType="com.spring.univ.model.MemberVO">
		update tbl_member set phone= #{phone}, email= #{email}, address= #{address}
		where hakbun = #{hakbun}
	</update>
	
	
	<!-- 마이페이지 보여주기 -->
	<select id="getMyMember" parameterType="HashMap" resultType="com.spring.univ.model.MemberVO">
		select name,hakbun,phone,email,address
		from tbl_member
		where hakbun = #{hakbun}
	</select>
<!-- === -->		



<!-- 내가 신청한 전공평가 가져오기 -->
	<select id="getServeyList" parameterType="String" resultMap="ServeyMap">
		select (select name
        		from tbl_member
        		where hakbun = t.fk_hakbun) as name, y.serveyTopic, y.serveyCode
		from tbl_servey y
		join tbl_subject t
		on y.serveyCode = t.code
		join tbl_sugang g
		on g.fk_code = t.code
		where g.fk_hakbun = #{hakbun}
		order by y.serveyCode
	</select>

	<resultMap type="HashMap" id="ServeyMap">
      <result property="name" column="name" javaType="String" />
       <result property="serveyTopic" column="serveyTopic" javaType="String" /> 
        <result property="serveyCode" column="serveyCode" javaType="String" />   
   </resultMap>

	<!-- 강의평가 했는지 확인하기 -->
	<select id="getServeyMemberList" parameterType="HashMap" resultType="String">
		select serveyDate
		from tbl_serveyMember
		where fk_hakbun = #{hakbun} and fk_serveyCode = #{serveyCode}
	</select>



</mapper>